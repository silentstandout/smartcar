let
    Source = Csv.Document(File.Contents("C:\Users\Kessel\Downloads\query_result_2024-02-09T02_10_46.94092Z.csv"),[Delimiter=",", Columns=75, Encoding=65001, QuoteStyle=QuoteStyle.Csv]),
    #"Promoted Headers" = Table.PromoteHeaders(Source, [PromoteAllScalars=true]),
    #"Replaced Value7" = Table.ReplaceValue(#"Promoted Headers","N/A","",Replacer.ReplaceText,{"Host Response Rate", "Host Acceptance Rate"}),
    #"Changed Type" = Table.TransformColumnTypes(#"Replaced Value7",{{"ID", Int64.Type}, {"Listing URL", type text}, {"Scrape ID", Int64.Type}, {"Last Scraped", type date}, {"Source", type text}, {"Name", type text}, {"Description", type text}, {"Neighborhood Overview", type text}, {"Picture URL", type text}, {"Host ID", Int64.Type}, {"Host URL", type text}, {"Host Name", type text}, {"Host Since", type date}, {"Host Location", type text}, {"Host About", type text}, {"Host Response Time", type text}, {"Host Response Rate", type text}, {"Host Acceptance Rate", type text}, {"Host Is Superhost", type text}, {"Host Thumbnail URL", type text}, {"Host Picture URL", type text}, {"Host Neighbourhood", type text}, {"Host Listings Count", Int64.Type}, {"Host Total Listings Count", Int64.Type}, {"Host Verifications", type text}, {"Host Has Profile Pic", type text}, {"Host Identity Verified", type text}, {"Neighbourhood", type text}, {"Neighbourhood Cleansed", type text}, {"Neighbourhood Group Cleansed", type text}, {"Latitude", type number}, {"Longitude", type number}, {"Property Type", type text}, {"Room Type", type text}, {"Accommodates", Int64.Type}, {"Bathrooms", type text}, {"Bathrooms Text", type text}, {"Bedrooms", Int64.Type}, {"Beds", Int64.Type}, {"Price", Currency.Type}, {"Minimum Nights", Int64.Type}, {"Maximum Nights", Int64.Type}, {"Minimum Minimum Nights", Int64.Type}, {"Maximum Minimum Nights", Int64.Type}, {"Minimum Maximum Nights", Int64.Type}, {"Maximum Maximum Nights", Int64.Type}, {"Minimum Nights Avg Ntm", type number}, {"Maximum Nights Avg Ntm", type number}, {"Calendar Updated", type text}, {"Has Availability", type text}, {"Availability 30", Int64.Type}, {"Availability 60", Int64.Type}, {"Availability 90", Int64.Type}, {"Availability 365", Int64.Type}, {"Calendar Last Scraped", type date}, {"Number Of Reviews", Int64.Type}, {"Number Of Reviews Ltm", Int64.Type}, {"Number Of Reviews L30d", Int64.Type}, {"First Review", type date}, {"Last Review", type date}, {"Review Scores Rating", type number}, {"Review Scores Accuracy", type number}, {"Review Scores Cleanliness", type number}, {"Review Scores Checkin", type number}, {"Review Scores Communication", type number}, {"Review Scores Location", type number}, {"Review Scores Value", type number}, {"License", type text}, {"Instant Bookable", type text}, {"Calculated Host Listings Count", Int64.Type}, {"Calculated Host Listings Count Entire Homes", Int64.Type}, {"Calculated Host Listings Count Private Rooms", Int64.Type}, {"Calculated Host Listings Count Shared Rooms", Int64.Type}, {"Reviews Per Month", type number}, {"Neighbourhood Group", type text}}),
    #"Changed Type1" = Table.TransformColumnTypes(#"Changed Type",{{"Host Response Rate", Percentage.Type}, {"Host Acceptance Rate", Percentage.Type}}),
    #"Removed Columns" = Table.RemoveColumns(#"Changed Type1",{"Calendar Updated"}),
    #"Replaced Value" = Table.ReplaceValue(#"Removed Columns","t","true",Replacer.ReplaceText,{"Host Is Superhost"}),
    #"Replaced Value1" = Table.ReplaceValue(#"Replaced Value","f","false",Replacer.ReplaceText,{"Host Is Superhost"}),
    #"Replaced Value2" = Table.ReplaceValue(#"Replaced Value1","t","true",Replacer.ReplaceText,{"Host Has Profile Pic", "Host Identity Verified"}),
    #"Replaced Value3" = Table.ReplaceValue(#"Replaced Value2","f","false",Replacer.ReplaceText,{"Host Has Profile Pic", "Host Identity Verified"}),
    #"Changed Type2" = Table.TransformColumnTypes(#"Replaced Value3",{{"Host Has Profile Pic", type logical}, {"Host Identity Verified", type logical}, {"Host Is Superhost", type logical}}),
    #"Replaced Value4" = Table.ReplaceValue(#"Changed Type2","Honolulu","O'ahu",Replacer.ReplaceText,{"Neighbourhood Group Cleansed"}),
    #"Replaced Value5" = Table.ReplaceValue(#"Replaced Value4","Hawaii","Hawai'i",Replacer.ReplaceText,{"Neighbourhood Group Cleansed"}),
    #"Replaced Value6" = Table.ReplaceValue(#"Replaced Value5","Kauai","Kaua'i",Replacer.ReplaceText,{"Neighbourhood Group Cleansed"}),
    #"Replaced Value8" = Table.ReplaceValue(#"Replaced Value6","t","true",Replacer.ReplaceText,{"Has Availability", "Instant Bookable"}),
    #"Replaced Value9" = Table.ReplaceValue(#"Replaced Value8","f","false",Replacer.ReplaceText,{"Has Availability", "Instant Bookable"}),
    #"Changed Type3" = Table.TransformColumnTypes(#"Replaced Value9",{{"Instant Bookable", type logical}, {"Has Availability", type logical}}),
    #"Renamed Columns" = Table.RenameColumns(#"Changed Type3",{{"Neighbourhood Group Cleansed", "Islands"}}),
    #"Added Conditional Column" = Table.AddColumn(#"Renamed Columns", "Room Type Corrected", each if [Property Type] = "Room in aparthotel" then "Hotel room" else if [Property Type] = "Room in boutique hotel" then "Hotel room" else if [Property Type] = "Room in hotel" then "Hotel room" else [Room Type]),
    #"Added Conditional Column1" = Table.AddColumn(#"Added Conditional Column", "minNightsCat", each if [Minimum Nights] > 0 and [Minimum Nights] <= 5 then "1-5" else if [Minimum Nights] > 5 and [Minimum Nights] <= 10 then "6-10" else if [Minimum Nights] > 10 and [Minimum Nights] <= 15 then "11-15" else if [Minimum Nights] > 15 and [Minimum Nights] <= 20 then "16-20" else if [Minimum Nights] > 20 and [Minimum Nights] <= 25 then "21-25" else if [Minimum Nights] > 25 and [Minimum Nights] <= 30 then "26-30" else if [Minimum Nights] > 30 then "31+" else 0),
    #"Added Conditional Column2" = Table.AddColumn(#"Added Conditional Column1", "maxNightsCat", each if [Maximum Nights] > 0 and [Maximum Nights] <= 15 then "1-15" else if [Maximum Nights] > 15 and [Maximum Nights] <= 30 then "16-30" else if [Maximum Nights] > 30 and [Maximum Nights] <= 60 then "31-60" else if [Maximum Nights] > 60 and [Maximum Nights] <= 100 then "61-100" else if [Maximum Nights] > 100 and [Maximum Nights] <= 200 then "101-200" else if [Maximum Nights] > 200 and [Maximum Nights] <= 500 then "201-500" else if [Maximum Nights] > 500 then "501+" else 0),
    #"Added Conditional Column3" = Table.AddColumn(#"Added Conditional Column2", "minNightsCatSort", each if [minNightsCat] = "1-5" then 1 else if [minNightsCat] = "6-10" then 2 else if [minNightsCat] = "11-15" then 3 else if [minNightsCat] = "16-20" then 4 else if [minNightsCat] = "21-25" then 5 else if [minNightsCat] = "26-30" then 6 else if [minNightsCat] = "31+" then 7 else null),
    #"Added Conditional Column4" = Table.AddColumn(#"Added Conditional Column3", "maxNightsCatSort", each if [maxNightsCat] = "1-15" then 1 else if [maxNightsCat] = "16-30" then 2 else if [maxNightsCat] = "31-60" then 3 else if [maxNightsCat] = "61-100" then 4 else if [maxNightsCat] = "101-200" then 5 else if [maxNightsCat] = "201-500" then 6 else if [maxNightsCat] = "501+" then 7 else null),
    #"Added Conditional Column5" = Table.AddColumn(#"Added Conditional Column4", "bathsCorrected", each if Text.Contains([Bathrooms Text], "alf") then "0.5 baths" else [Bathrooms Text]),
    #"Replaced Value10" = Table.ReplaceValue(#"Added Conditional Column5","","0 baths",Replacer.ReplaceValue,{"bathsCorrected"}),
    #"Split Column by Delimiter" = Table.SplitColumn(#"Replaced Value10", "bathsCorrected", Splitter.SplitTextByEachDelimiter({" "}, QuoteStyle.Csv, false), {"bathsCorrected.1", "bathsCorrected.2"}),
    #"Changed Type4" = Table.TransformColumnTypes(#"Split Column by Delimiter",{{"bathsCorrected.1", type number}, {"bathsCorrected.2", type text}}),
    #"Removed Columns1" = Table.RemoveColumns(#"Changed Type4",{"bathsCorrected.2"}),
    #"Renamed Columns1" = Table.RenameColumns(#"Removed Columns1",{{"bathsCorrected.1", "Baths"}})
in
    #"Renamed Columns1"
